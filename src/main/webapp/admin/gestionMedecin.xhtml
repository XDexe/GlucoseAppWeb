<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>Gestion médecin</title>
    <h:outputStylesheet library="css" name="cssTemp.css"/>
</h:head>

<h:body id="bodyElement">
    <div class="header">
        <div class="drop">
            <input class="dropdown" type="checkbox" id="dropdown2" name="dropdown"/>
            <label class="profile-image" for="dropdown2">
                <h:graphicImage library="images" name="Screenshot 2023-11-29 160453.png" alt="Profile"/>
            </label>
            <div class="section-dropdown">
                <div class="toggle-switch">
                    <input type="checkbox" id="themeToggle" onchange="toggleTheme()"/>
                    <label class="slider" for="themeToggle"></label>
                </div>
                <p:commandButton styleClass="custom-btn" value="Modifier votre profil"
                                 actionListener="#{categorieController.resetForm()}"
                                 update=""
                                 oncomplete="PF('').show()"/>
                <p:commandButton value="Contacter votre medecin"
                                 actionListener="#{categorieController.resetForm()}"
                                 update=""
                                 styleClass="custom-btn"
                                 oncomplete="PF('').show()"/>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        function toggleTheme() {
            var body = document.getElementById('bodyElement');
            body.classList.toggle('light-theme');
        }
    </script>

    <div id="appContainer">
        <div class="locked-table">
            <h:form id="formMedecins">

                <p:dataTable value="#{medecinController.medecins}" var="medecin">

                    <p:column headerText="Photo">
                        <h:graphicImage library="photo-profil"
                                        name="#{medecin.photoDeProfilUrl}"
                                        alt="Profile photo"
                                        style="max-height:50px; width:auto; height:auto;"/>
                    </p:column>
                    <p:column headerText="Nom">
                        <h:outputText value="#{medecin.nom}"/>
                    </p:column>
                    <p:column headerText="Prénom">
                        <h:outputText value="#{medecin.prenom}"/>
                    </p:column>
                    <p:column headerText="Actions">
                        <p:commandButton icon="pi pi-pencil"
                                         action="#{medecinController.loadMedecin(medecin)}"
                                         update=":formAddMedecin" oncomplete="PF('dlgAddMedecin').show()"
                                         title="Modifier"/>
                        <p:commandButton icon="pi pi-trash"
                                         action="#{medecinController.deleteMedecin(medecin)}"
                                         update="formMedecins" title="Supprimer"/>
                    </p:column>
                </p:dataTable>
            </h:form>
        </div>
    </div>
    <div class="bottom">
        <p:commandButton value="Ajouter un médecin"
                         actionListener="#{medecinController.resetForm()}"
                         update="formAddMedecin"
                         oncomplete="PF('dlgAddMedecin').show()"
                         styleClass="button-bottom"/>
    </div>

    <p:dialog styleClass="dialog" widgetVar="dlgAddMedecin" modal="true" resizable="false" draggable="false"
              closeOnEscape="true" showEffect="fade" hideEffect="fade" width="50%" bottom="0" left="50%">

        <h:form id="formAddMedecin" enctype="multipart/form-data">
            <h:inputHidden value="#{medecinController.medecin.idPersonne}"/>

            <p:panelGrid columns="2" styleClass="grid">

                <h:outputLabel value="Nom :"/>
                <p:inputText value="#{medecinController.medecin.nom}"/>

                <h:outputLabel value="Prénom :"/>
                <p:inputText value="#{medecinController.medecin.prenom}"/>

                <h:outputLabel value="Identifiant:"/>
                <p:inputText value="#{medecinController.medecin.identifiant}"/>

                <h:outputLabel value="Mot de passe:"/>
                <p:password value="#{medecinController.medecin.motDePasse}"/>

                <h:outputLabel value="Utilisateur :"/>
                <p:selectOneMenu  id="utilisateur" value="#{medecinController.utilisateurSelectionne.idPersonne}" required="true">
                    <f:selectItem itemLabel="Choisir un utilisateur" itemValue="" />
                    <f:selectItems value="#{utilisateurController.read()}" var="user"
                                   itemLabel="#{user.nom}" itemValue="#{user.idPersonne}" />
                </p:selectOneMenu>

                <p:fileUpload mode="simple"
                              value="#{personneController.uploadedFile}"
                              sizeLimit="100000000"
                              allowTypes="/(\.|\/)(jpg|jpeg|png)$/"
                              dragDropSupport="false"/>
            </p:panelGrid>

            <p:separator/>

            <p:commandButton value="Enregistrer"
                             actionListener="#{medecinController.editMedecin()}"
                             oncomplete="PF('dlgAddMedecin').hide()"
                             update="formMedecins"
                             icon="pi pi-check"/>

            <p:commandButton value="Annuler"
                             type="button"
                             onclick="PF('dlgAddMedecin').hide()"
                             icon="pi pi-times"/>
        </h:form>
    </p:dialog>
</h:body>
</html>
